# WeMine Test Cases by Muhammad Yusuf
Test case including functional and API Test with test method manual/automation explanation

## Flow 2 - Safety Hazard Report
### Functional Test Cases
#### TC-HAZARD-F001: Create Hazard Report - Mobile Precondition: User logged in with role authorized to report hazard Test Steps:
1. Navigate to "Hazard" menu
2. Tap "New Report" button
3. Fill mandatory fields:
    * Location: Select "Zone A"
    * Sublocation: Select "Building 1"
    * Area: Select "Workshop"
    * Area Description: Leave empty (optional)
    * Evidence: Upload image
    * PIC: Verify preselected to reporter, change if needed
4. Submit report
Expected Result:
* Form submission successful
* Hazard entry created
* Followup task generated for PIC
* Reporter receives confirmation
* PIC receives notification
* All people in the area receive hazard notification
* Report appears in hazard list
Test Method: Manual Testing with notification monitoring Reason: Multi-stakeholder notification requires end-to-end validation

#### TC-HAZARD-F002: View Hazard List Precondition: Multiple hazard reports exist Test Steps:
1. Open Hazard menu
2. Verify list displays all reports
3. Verify each report shows: Location, Status, Date, Severity
4. Tap on a report
5. Verify detail view opens
Expected Result:
* List loads correctly
* Filtering and sorting work
* Status indicators accurate
* Detail view shows complete information
Test Method: Manual Testing Reason: UI/UX validation

#### TC-HAZARD-F003: PIC Followup Task - Complete Resolution Precondition: PIC has received followup task notification Test Steps:
1. PIC opens notification
2. Navigate to task detail
3. Fill resolution fields:
    * Evidence: Upload image of resolved issue
    * Resolution Date: Select current datetime
    * Co Observer: Add 2 observers
4. Submit followup
Expected Result:
* Followup task marked as completed
* Hazard status updated
* Direct Supervisor receives notification
* Co-observers linked to task
* Resolution evidence uploaded successfully
Test Method: Manual Testing Reason: Workflow validation with multiple actors

#### TC-HAZARD-F004: Add Multiple Co-Observers Precondition: PIC on followup task page Test Steps:
1. Tap (+) button next to Co Observer
2. Add 3 co-observers
3. Verify each has separate select field
4. Remove one co-observer
5. Submit form
Expected Result:
* Dynamic field addition works
* Each observer can be selected independently
* Removal works correctly
* Minimum validation (if any) enforced
* All observers saved with task
Test Method: Manual Testing Reason: Dynamic form element testing

#### TC-HAZARD-F005: Notification Delivery Validation Precondition: Test accounts for Reporter, PIC, Area Workers, Supervisor Test Steps:
1. Reporter creates hazard report
2. Monitor notifications for:
    * PIC (followup task)
    * All workers in affected area (hazard alert)
3. PIC completes followup
4. Monitor notification for Supervisor
Expected Result:
* All stakeholders receive appropriate notifications
* Notifications delivered within 1 minute
* Notification content accurate
* Deep links work correctly
Test Method: Manual Testing with multiple devices/accounts Reason: End-to-end notification chain validation

#### TC-HAZARD-F006: Hazard Report Offline Submission Precondition: User offline Test Steps:
1. Disable network
2. Create hazard report
3. Verify saved locally with "Pending" status
4. Enable network
5. Verify auto-sync occurs
6. Verify notifications sent after sync
Expected Result:
* Offline submission works
* Data persisted locally
* Sync successful when online
* Notifications sent after sync
* Status updated correctly
Test Method: Manual Testing Reason: Offline scenario testing

#### TC-HAZARD-F007: Image Evidence Validation Precondition: User creating hazard report Test Steps:
1. Attempt to proceed without uploading evidence
2. Verify validation error
3. Upload valid image
4. Verify preview shown
5. Verify can replace image
6. Submit with image
Expected Result:
* Mandatory validation works
* Image preview functional
* Image replacement works
* Submission includes image
* Image viewable in detail view
Test Method: Manual Testing Reason: Media handling validation

#### TC-HAZARD-F008: Supervisor Review and Approval Precondition: Supervisor has received followup completion notification Test Steps:
1. Supervisor opens notification
2. Review hazard details
3. Review followup evidence
4. Verify resolution information
5. Approve or reject (if system supports)
Expected Result:
* All information visible to supervisor
* Images load correctly
* Timeline of events clear
* Action taken recorded (if applicable)
Test Method: Manual Testing Reason: Supervisor workflow validation

#### TC-HAZARD-F009: Cross-Platform Hazard Visibility Precondition: User has access to both Mobile and Web Test Steps:
1. Create hazard report on Mobile
2. Wait for sync
3. Login to WeMineOffice Web
4. Navigate to hazard list
5. Verify hazard visible
6. Open hazard detail
7. Verify all data matches including images
Expected Result:
* Hazard visible on both platforms
* All fields consistent
* Images accessible
* Status synchronized
* Notifications delivered to both platforms
Test Method: Manual Testing Reason: Cross-platform data consistency

#### TC-HAZARD-F010: Real-time Data Sync Precondition: User logged in both Mobile and Web Test Steps:
1. Create hazard report on Mobile
2. Monitor Web dashboard
3. Verify hazard appears on Web (with refresh)
4. Complete followup on Mobile
5. Verify status updated on Web
Expected Result:
* Data sync within acceptable time (< 2 minutes)
* Status updates reflected
* No data discrepancies
* Timestamps consistent
Test Method: Manual Testing Reason: Real-time sync validation

#### TC-HAZARD-F011: Offline Hazard Data Persistence Precondition: User has created hazards offline Test Steps:
1. Disable network
2. Create 3 hazard reports
3. Close application
4. Reopen application (still offline)
5. Verify all hazards exist
6. Enable network
7. Verify all sync successfully
Expected Result:
* All offline hazards persisted
* Data displayed with "Pending" status
* No data loss after app restart
* Successful sync when online
* Notifications sent after sync
Test Method: Manual Testing Reason: Offline data persistence validation

#### TC-HAZARD-F012: Notification Delivery - Both Platforms Precondition: User has both Mobile app and Web access Test Steps:
1. Trigger notification event (e.g., hazard assignment)
2. Verify push notification on Mobile
3. Verify notification badge on Web
4. Open notification on Mobile
5. Mark as read
6. Verify read status on Web
Expected Result:
* Notification delivered to both platforms
* Content consistent
* Deep links work on both
* Read status synced
* No duplicate notifications
Test Method: Manual Testing Reason: Multi-platform notification testing

#### TC-HAZARD-F013: Permission Consistency Across Platforms Precondition: User with specific role/permissions Test Steps:
1. Login to Mobile with limited permissions
2. Verify restricted features not accessible
3. Login to Web with same account
4. Verify same restrictions applied
5. Test feature access boundaries
Expected Result:
* Permissions enforced consistently
* UI adapts to permissions
* Error messages consistent
* No security bypasses
Test Method: Manual Testing Reason: Security and authorization validation

### API Test Cases
#### TC-HAZARD-API001: POST Create Hazard Report Endpoint: /safety/hazard Method: POST Request:
{
  "location_id": "loc-001",
  "sublocation_id": "subloc-001",
  "area_id": "area-001",
  "area_description": "Near conveyor belt #3",
  "evidence_image_id": "img-101",
  "pic_user_id": "user-002",
  "reporter_user_id": "user-001",
  "severity": "high",
  "reported_at": "2025-11-20T10:00:00Z"
}
Expected Response:
{
  "status": 201,
  "data": {
    "hazard_id": "hazard-001",
    "status": "reported",
    "followup_task_id": "task-001",
    "created_at": "2025-11-20T10:00:00Z"
  }
}
Test Method: Automated API Testing Reason: Core safety functionality

#### TC-HAZARD-API002: POST Create Hazard - Missing Mandatory Field Endpoint: /safety/hazard Method: POST Request:
{
  "location_id": "loc-001",
  "sublocation_id": "subloc-001"
}
Expected Response:
{
  "status": 400,
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "Required fields missing",
    "details": [
      {"field": "area_id", "message": "Area is required"},
      {"field": "evidence_image_id", "message": "Evidence is required"},
      {"field": "pic_user_id", "message": "PIC is required"}
    ]
  }
}
Test Method: Automated API Testing Reason: Validation enforcement

#### TC-HAZARD-API003: GET Hazard List with Filters Endpoint: /safety/hazard Method: GET Query Parameters:
?location_id=loc-001&status=open&from_date=2025-11-01&to_date=2025-11-30
Expected Response:
{
  "status": 200,
  "data": {
    "total": 15,
    "hazards": [
      {
        "hazard_id": "hazard-001",
        "location_name": "Zone A",
        "sublocation_name": "Building 1",
        "area_name": "Workshop",
        "severity": "high",
        "status": "open",
        "reported_at": "2025-11-20T10:00:00Z",
        "reporter_name": "John Doe",
        "pic_name": "Jane Smith"
      }
    ]
  }
}
Test Method: Automated API Testing Reason: Filtering and pagination testing

#### TC-HAZARD-API004: GET Hazard Detail Endpoint: /safety/hazard/{hazard_id} Method: GET Expected Response:
{
  "status": 200,
  "data": {
    "hazard_id": "hazard-001",
    "location": {...},
    "sublocation": {...},
    "area": {...},
    "area_description": "Near conveyor belt #3",
    "evidence_url": "https://cdn.wemine.com/images/hazard-001.jpg",
    "pic": {
      "user_id": "user-002",
      "full_name": "Jane Smith"
    },
    "reporter": {...},
    "status": "in_progress",
    "followup_task": {
      "task_id": "task-001",
      "status": "pending"
    },
    "created_at": "2025-11-20T10:00:00Z",
    "updated_at": "2025-11-20T10:05:00Z"
  }
}
Test Method: Automated API Testing Reason: Data structure validation

#### TC-HAZARD-API005: POST Complete Followup Task Endpoint: /workflow/task/{task_id}/complete Method: POST Request:
{
  "resolution_evidence_id": "img-102",
  "resolution_date": "2025-11-20T14:30:00Z",
  "co_observers": ["user-003", "user-004"],
  "notes": "Issue resolved, new safety signage installed"
}
Expected Response:
{
  "status": 200,
  "data": {
    "task_id": "task-001",
    "status": "completed",
    "completed_at": "2025-11-20T14:30:00Z",
    "hazard_id": "hazard-001",
    "hazard_status": "resolved"
  }
}
Test Method: Automated API Testing Reason: Task completion flow validation

#### TC-HAZARD-API006: Notification Trigger Validation Test Steps:
1. POST Create Hazard
2. Verify notification API called for:
    * PIC (followup task)
    * Area workers (hazard alert)
3. POST Complete Followup
4. Verify notification API called for:
    * Supervisor (review request)
Expected Result:
* Notification service receives correct payloads
* Recipient lists accurate
* Notification types appropriate
* Deep links included
Test Method: Automated API Testing with mock notification service Reason: Integration testing for notification chain

#### TC-HAZARD-API007: GET Users by Area Endpoint: /master/employees Method: GET Query Parameters:
?area_id=area-001&include_inactive=false
Expected Response:
{
  "status": 200,
  "data": {
    "area_id": "area-001",
    "area_name": "Workshop",
    "employees": [
      {
        "user_id": "user-001",
        "full_name": "John Doe",
        "role": "operator",
        "status": "active"
      },
      {
        "user_id": "user-002",
        "full_name": "Jane Smith",
        "role": "supervisor",
        "status": "active"
      }
    ]
  }
}
Test Method: Automated API Testing Reason: Data retrieval for notification targeting

#### TC-HAZARD-API008: POST Bulk Hazard Sync (Offline) Endpoint: /safety/hazard/bulk-sync Method: POST Request:
{
  "hazards": [
    {
      "local_id": "local-hazard-001",
      "location_id": "loc-001",
      "sublocation_id": "subloc-001",
      "area_id": "area-001",
      "evidence_image_id": "img-101",
      "pic_user_id": "user-002",
      "reported_at": "2025-11-20T08:00:00Z"
    },
    {
      "local_id": "local-hazard-002",
      "location_id": "loc-002",
      "sublocation_id": "subloc-003",
      "area_id": "area-005",
      "evidence_image_id": "img-102",
      "pic_user_id": "user-003",
      "reported_at": "2025-11-20T09:30:00Z"
    }
  ]
}
Expected Response:
{
  "status": 200,
  "data": {
    "success_count": 2,
    "failed_count": 0,
    "results": [
      {
        "local_id": "local-hazard-001",
        "hazard_id": "hazard-101",
        "status": "success"
      },
      {
        "local_id": "local-hazard-002",
        "hazard_id": "hazard-102",
        "status": "success"
      }
    ]
  }
}
Test Method: Automated API Testing Reason: Critical for offline functionality at mining sites

#### TC-HAZARD-API009: GET Notification History Endpoint: /notification/history Method: GET Query Parameters:
?user_id=user-002&type=hazard&limit=20
Expected Response:
{
  "status": 200,
  "data": {
    "notifications": [
      {
        "notification_id": "notif-001",
        "type": "hazard_followup",
        "title": "New Followup Task Assigned",
        "message": "You have been assigned as PIC for hazard #hazard-001",
        "reference_id": "hazard-001",
        "reference_type": "hazard",
        "status": "read",
        "sent_at": "2025-11-20T10:00:30Z",
        "read_at": "2025-11-20T10:05:00Z"
      }
    ]
  }
}
Test Method: Automated API Testing Reason: Notification delivery tracking

#### TC-HAZARD-API010: Session Consistency Endpoint: /user/sessions Method: GET Expected Response:
{
  "status": 200,
  "data": {
    "active_sessions": [
      {
        "session_id": "sess-001",
        "device_type": "mobile",
        "platform": "android",
        "last_active": "2025-11-20T10:00:00Z"
      },
      {
        "session_id": "sess-002",
        "device_type": "web",
        "platform": "chrome",
        "last_active": "2025-11-20T10:05:00Z"
      }
    ]
  }
}
Test Method: Automated API Testing Reason: Session management validation
